---
title: Java Native执行顺序
---
<!--more-->
---
## native方法调用步骤
### 编译java代码生成class文件：`javac HelloNative.java`
```java
public class HelloNative {
	static{
		System.loadLibrary("HelloNative");
	}
	
	public native void sayHello();
	public native void goodTime();
	public native String outDate(String str, Date d);
	
	public static void main(String[] args) {
		new HelloNative().sayHello();
		new HelloNative().goodTime();
		new HelloNative().outDate("dd", new Date());
	}
}
```
### 生成HelloNative.h头文件： `javah HelloNative`
```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class HelloNative */

#ifndef _Included_HelloNative
#define _Included_HelloNative
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     HelloNative
 * Method:    sayHello
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_HelloNative_sayHello
  (JNIEnv *, jobject);

/*
 * Class:     HelloNative
 * Method:    goodTime
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_HelloNative_goodTime
  (JNIEnv *, jobject);

/*
 * Class:     HelloNative
 * Method:    outDate
 * Signature: (Ljava/lang/String;Ljava/util/Date;)Ljava/lang/String;
 */
JNIEXPORT jstring JNICALL Java_HelloNative_outDate
  (JNIEnv *, jobject, jstring, jobject);

#ifdef __cplusplus
}
#endif
#endif
```



### 创建HelloNative.c文件
```
	#include "HelloNative.h"
	#include <stdio.h>
	JNIEXPORT void JNICALL Java_HelloNative_sayHello(JNIEnv *env,jobject obj){
	printf("Hello World!\n");
			return;
	}

	JNIEXPORT jstring JNICALL Java_HelloNative_outDate(JNIEnv *env, jobject obj, jstring s, jobject d){
			printf("Hell Date\n");
	}

	JNIEXPORT void JNICALL Java_HelloNative_goodTime(JNIEnv *env, jobject obj){
			printf("Java_HelloNative_goodTime\n");
	}
```

### 生成dll动态链接库：（需要使用64位的gcc编译器）打开cmd命令执行：
 ```
 F:\workspace\NativeDemo\bin>gcc -m64  -Wl,--add-stdcall-alias -I"D:\study\tools\jdk\x64\1.7.0_71\include" -I"D:\study\tools\jdk\x64\1.7.0_71\include\win32"  -shared -o HelloNative.dll HelloNative.c
 ```
### 将生成的HelloNative.dll文件放入到系统path路径下
输出结果为：
```
Hello World!
Java_HelloNative_goodTime
Hell Date
```